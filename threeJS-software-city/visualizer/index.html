<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="visualizer" content="width=device-width, initial-scale=1.0">
    <title>Software City Visualizer</title>

    <link rel="stylesheet" href="index.css">

    <style>
        .slider-container {
            display: none;
            position: absolute;
            top: 89%;
            left: 35%;
            width: 30%;
            margin: 0 auto;
            text-align: center;
        }

        .slider {
            width: 100%;
            height: 20px;
            background-color: #ccc;
            position: relative;
        }

        .slider-thumb {
            width: 20px;
            height: 20px;
            background-color: red;
            position: absolute;
            cursor: pointer;
        }

        #slider-value {
            color: red;
            user-select: none;
        }
    </style>
</head>

<body>

    <div id="navbar" class="navbar">
        <button id="nav-btn-upload">Upload</button>
        <button id="nav-btn-grouping">Grouping</button>
        <button id="nav-btn-visualize">Visualize</button>
    </div>

    <div id="grouping-form" class="metaphors-form">
        <span class="btn-close">&times;</span>
        <button class="dropbtn">Grouping</button>
        <div class="dropdown-content">
            <div class="grouping-source" id="groupingSource">
                SourceGroup
            </div>
            <div class="grouping-target" id="groupingTarget">
                TargetGroup
            </div>
        </div>
    </div>

    <div id="upload-form" class="metaphors-form">
        <span class="btn-close">&times;</span>
        <form id="upload-data-form">
            <label for="file">Choose a .csv file:</label>
            <input type="file" id="file" name="file" accept=".csv" required>

            <label for="file-format">Select a type:</label>
            <select id="file-format" name="file-format">
                <option value="java-source-code">Java Source Code</option>
                <option value="bpmn">BPMN</option>
                <option value="generic">Generic</option>
            </select>

            <button id="upload-data-button" type="button">Upload Data</button>
        </form>
    </div>

    <div id="metaphors-form" class="metaphors-form">
        <span class="btn-close">&times;</span>
        <div>
            <label for="dimension-attribute-selection">Dimension:</label>
            <select id="dimension-attribute-selection" name="dimension-attribute-selection">
            </select>
        </div>
        <div>
            <label for="height-attribute-selection">Height:</label>
            <select id="height-attribute-selection" name="height-attribute-selection">
            </select>
        </div>
        <div>
            <label for="color-attribute-selection">Color:</label>
            <select id="color-attribute-selection" name="color-attribute-selection">
            </select>
        </div>

        <label for="city-dimension">City Dimension:</label>
        <input type="text" id="city-dimension" name="city-dimension" placeholder="Enter City Dimension">

        <label for="city-spread">City Spread:</label>
        <input type="text" id="city-spread" name="city-spread" placeholder="Enter City Spread">

        <button id="btn-go">Go!</button>
    </div>

    <div id="slider-container" class="slider-container">
        <div class="slider">
            <div class="slider-thumb"></div>
        </div>
        <p><span id="slider-value">2024-01-01, 10:00:00:000</span></p>
    </div>

    <script type="module" src="./app/adapters/in/visualizeWebController.js"></script>
    <script>
        document.getElementById('nav-btn-visualize').addEventListener('click', event => {
            document.getElementById('grouping-form').style.display = 'none';
            document.getElementById('upload-form').style.display = 'none';
            let metaphorsForm = document.getElementById('metaphors-form');
            if(metaphorsForm.style.display === 'none' || metaphorsForm.style.display === ''){
                metaphorsForm.style.display = 'block';
            } else {
                metaphorsForm.style.display = 'none';
            }
        });
        document.getElementById('nav-btn-upload').addEventListener('click', event => {
            document.getElementById('grouping-form').style.display = 'none';
            document.getElementById('metaphors-form').style.display = 'none';
            let metaphorsForm = document.getElementById('upload-form');
            if(metaphorsForm.style.display === 'none' || metaphorsForm.style.display === ''){
                metaphorsForm.style.display = 'block';
            } else {
                metaphorsForm.style.display = 'none';
            }
        });
        document.getElementById('nav-btn-grouping').addEventListener('click', event => {
            document.getElementById('upload-form').style.display = 'none';
            document.getElementById('metaphors-form').style.display = 'none';
            let metaphorsForm = document.getElementById('grouping-form');
            if(metaphorsForm.style.display === 'none' || metaphorsForm.style.display === ''){
                metaphorsForm.style.display = 'block';
            } else {
                metaphorsForm.style.display = 'none';
            }
        });
        let closeButtons = document.getElementsByClassName('btn-close');
        for(let i = 0; i < closeButtons.length; i++){
            closeButtons[i].addEventListener('click', event => {
                document.getElementById('grouping-form').style.display = 'none';
                document.getElementById('upload-form').style.display = 'none';
                document.getElementById('metaphors-form').style.display = 'none';
            });
        }
        document.addEventListener('keydown', event => {
            if(event.key === 'Escape'){
                document.getElementById('grouping-form').style.display = 'none';
                document.getElementById('upload-form').style.display = 'none';
                document.getElementById('metaphors-form').style.display = 'none';
            }
        })
    </script>

<!--    <script>-->
<!--        document.getElementById('slider-container').style.display = 'none';-->
<!--        const slider = document.querySelector('.slider');-->
<!--        const thumb = document.querySelector('.slider-thumb');-->
<!--        const valueDisplay = document.getElementById('slider-value');-->

<!--        let isDragging = false;-->

<!--        thumb.addEventListener('mousedown', () => {-->
<!--            isDragging = true;-->
<!--        });-->

<!--        document.addEventListener('mouseup', () => {-->
<!--            isDragging = false;-->
<!--        });-->

<!--        document.addEventListener('mousemove', (e) => {-->
<!--            if (isDragging) {-->
<!--                const mouseX = e.clientX - slider.getBoundingClientRect().left;-->
<!--                const percent = (mouseX / slider.clientWidth) * 100;-->
<!--                const newValue = Math.min(100, Math.max(0, percent));-->
<!--                thumb.style.left = `${newValue}%`;-->
<!--                valueDisplay.textContent = `2000-01-01T10:30:${Math.round(newValue)}:500`;-->
<!--            }-->
<!--        });-->
<!--    </script>-->


</body>

</html>